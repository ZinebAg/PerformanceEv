## 2
install.packages("ggpubr")
library(ggpubr)
#Analyze the performance with AP = S = 1 by plotting the various performance metrics versus C.
#What can you conclude from there ?

obs1 <- matrix(nrow = 51,ncol = 7)
colnames(obs1)<-c("C","AP","S","thetha","PPS","CPS","d")

# now the runnings
#####
obs1[1,]<-c(1,1,1,0.943,0.000,0.000012,0.164462)
obs1[2,]<-c(20,1,1,19.656,121.847,0.000122,0.306908)
obs1[3,]<-c(40,1,1,37.791,200.370,0.001406,0.660043)
obs1[4,]<-c(60,1,1,56.447,308.063,0.016193,1.086610)
obs1[5,]<-c(80,1,1,79.502,392.983,0.170476,2.894217)
obs1[6,]<-c(100,1,1,98.866,539.276,0.871339,5.232287)
obs1[7,]<-c(120,1,1,111.300,658.594,0.987813,9.495328)
obs1[8,]<-c(140,1,1,118.156,586.092,0.999012,13.838694)
obs1[9,]<-c(160,1,1,129.240,791.792,1.000000,29.002573)
obs1[10,]<-c(180,1,1,133.939,728.338,1.000000,30.511928)
obs1[11,]<-c(200,1,1,133.585,706.830,0.991750,41.248431)
obs1[12,]<-c(220,1,1,146.443,769.809,1.000000,42.526359)
obs1[13,]<-c(240,1,1,150.754,794.134,0.996489,53.158862)
obs1[14,]<-c(260,1,1,157.844,950.241,0.998767,68.588788)
obs1[15,]<-c(280,1,1,153.511,933.054,1.000000,66.019821)
obs1[16,]<-c(300,1,1,165.437,981.702,1.000000,64.524297)
obs1[17,]<-c(320,1,1,173.371,987.742,0.986687,88.788742)
obs1[18,]<-c(340,1,1,174.394,1024.603,0.999391,94.435431)
obs1[19,]<-c(360,1,1,172.131,1154.250,0.995140,131.878098)
obs1[20,]<-c(380,1,1,183.883,943.936,1.000000,193.470679)
obs1[21,]<-c(400,1,1,184.969,1145.963,1.000000,193.470679)
obs1[22,]<-c(420,1,1,186.898,1157.995,1.000000,211.796123)
obs1[23,]<-c(440,1,1,189.828,1181.243,0.986004,175.931834)
obs1[24,]<-c(460,1,1,199.839,1346,0.995754,331.290513)
obs1[25,]<-c(480,1,1,203.333,1404.948,0.995754,331.290513)
obs1[26,]<-c(500,1,1,193.033,1375.209,1.000000,321.016293)
obs1[27,]<-c(520,1,1,206.430,1319.965,1.000000,334.437084)
obs1[28,]<-c(540,1,1,211.448,1399.715,1.000000,480.210134)
obs1[29,]<-c(560,1,1,204.182,1302.989,1.000000,477.517675)
obs1[30,]<-c(580,1,1,217.080,1627.332,1.000000,563.325721)
obs1[31,]<-c(600,1,1,206.732,1372.687,1.000000,605.723301)
obs1[32,]<-c(620,1,1,220.216,1314.058,1.000000,697.208547)
obs1[33,]<-c(640,1,1,221.821,1360.037,1.000000,602.113481)
obs1[34,]<-c(660,1,1,214.733,1635.937,1.000000,611.953827)
obs1[35,]<-c(680,1,1,219.375,1557.944,1.000000,702.335473)
obs1[36,]<-c(700,1,1,231.574,1648.185,1.000000,717.326775)
obs1[37,]<-c(720,1,1,236.663,1664.315,1.000000,818.139785)
obs1[38,]<-c(740,1,1,223.639,1656.161,1.000000,809.041196)
obs1[39,]<-c(760,1,1,241.190,1894.144,1.000000,802.286151)
obs1[40,]<-c(780,1,1,241.034,1885.008,0.995781,711.666381)
obs1[41,]<-c(800,1,1,229.420,1752.292,1.000000,862.010248)
obs1[42,]<-c(820,1,1,234.415,1688.597,0.982685,830.724984)
obs1[43,]<-c(840,1,1,245.579,1825.727,0.994525,847.842941)
obs1[44,]<- c(1000,1,1,254.959,2043.828,0.987302,924.518831)
obs1[45,]<-c(860,1,1,251.725,1857.840,0.995569,866.493007)
obs1[46,]<-c(880,1,1,242.164,1947.311,0.982454,898.371989)
obs1[47,]<-c(900,1,1,254.639,1943.957,0.997270,842.366062)
obs1[48,]<-c(920,1,1,255.573 ,2120.284,1.000000,944.158528)
obs1[49,]<-c(940,1,1,244.904,2054.047,1.000000,935.508509)
obs1[50,]<-c(960,1,1,249.680,1947.297,1.000000,896.969984)
obs1[51,]<-c(980,1,1,250.413,2191.486,1.000000,938.740258)


write.table(round(obs1,3),paste0("/Users/Mac/Desktop/lec/hw1data1.txt"),quote = F,row.names = F,sep = "\t")

##### first plots

par(mfrow=c(2,2))
plot(x=obs1[,1],y=obs1[,4],xlab= "C" ,ylab= "θ",ylim =c(0,max(y=obs1[,4])))
abline(lm(obs1[,4] ~ obs1[,1]), col="red")
abline(lm(obs1[(1:7),4] ~ obs1[(1:7),1]), col="blue")
plot(x=obs1[,1],y=obs1[,5],xlab= "C" ,ylab= "pps", ylim =c(0,max(y=obs1[,5])))
abline(lm(obs1[,5] ~ obs1[,1]), col="red")
abline(lm(obs1[(1:7),5] ~ obs1[(1:7),1]), col="blue")
plot(x=obs1[,1],y=obs1[,6],xlab= "C" ,ylab= "cps", ylim =c(0,max(y=obs1[,6])))
plot(x=obs1[,1],y=obs1[,7],xlab= "C" ,ylab= "d", ylim =c(0,max(y=obs1[,7])))



## 3

# Someone suggests to you that a solution is to double the number of access points. Pose this conclusion
# as a hypothesis and verify it by running other simulations.

#doubling the access points from 1 to 2 
obs2 <- matrix(nrow = 51,ncol = 7)
colnames(obs2)<-c("C","AP","S","thetha","PPS","CPS","d")



obs2[1,]<-c(1,2,1,0.963,0.021,0.000012,0.158247)
obs2[2,]<-c(20,2,1,18.853,127.793,0.000039,0.296879)
obs2[3,]<-c(40,2,1,38.897,235.981,0.000177,0.633365)
obs2[4,]<-c(60,2,1,59.005,251.683,0.000482,1.604239)
obs2[5,]<-c(80,2,1,77.861,394.295,0.001564,2.637980)
obs2[6,]<-c(100,2,1,93.637,526.486,0.005061,3.938962)
obs2[7,]<-c(120,2,1,112.894,508.536,0.013827,14.298952)
obs2[8,]<-c(140,2,1,135.443,802.637,0.060466,32.890445)
obs2[9,]<-c(160,2,1,158.858,738.536,0.212916,63.132478)
obs2[10,]<-c(180,2,1,172.402,912.077,0.584847,130.667456)
obs2[11,]<-c(200,2,1,190.508,980.415,0.881558,233.676899)
obs2[12,]<-c(220,2,1,205.432,1185.657,0.975630,482.814471)
obs2[13,]<-c(240,2,1,223.353,1145.602,0.987884,692.400490)
obs2[14,]<-c(260,2,1,227.594,1305.815,0.996361,775.415744)
obs2[15,]<-c(280,2,1,241.210,1328.970,1.000000,803.146628)
obs2[16,]<-c(300,2,1,247.188,1234.091,1.000000,839.129863)
obs2[17,]<-c(320,2,1,247.134,1305.868,1.000000,870.764805)
obs2[18,]<-c(340,2,1,249.669,1411.878,1.000000,877.660603)
obs2[19,]<-c(360,2,1,	271.794,1206.682,1.000000,930.439875)
obs2[20,]<-c(380,2,1,270.928,1562.016,0.990076,968.107125)
obs2[21,]<-c(400,2,1,272.644,1453.320,0.992784,920.022746)
obs2[22,]<-c(420,2,1,278.004,1739.301,0.971201,1003.323388)
obs2[23,]<-c(440,2,1,296.797,1509.565,0.984873,973.801653)
obs2[24,]<-c(460,2,1,302.659,1938.341,1.000000,947.967021)
obs2[25,]<-c(480,2,1,307.808,1581.289,0.994824,999.330648)
obs2[26,]<-c(500,2,1,276.305,1805.408,0.996864,966.442916)
obs2[27,]<-c(520,2,1,259.830,1710.114,1.000000,991.101662)
obs2[28,]<-c(540,2,1,234.882,1618.196,0.997398,975.960009)
obs2[29,]<-c(560,2,1,222.021,1645.483,1.000000,1029.790078)
obs2[30,]<-c(580,2,1,218.710,1414.138,1.000000,977.244579)
obs2[31,]<-c(600,2,1,208.689,1380.197,0.977080,1034.579190)
obs2[32,]<-c(620,2,1,186.894,1260.271,1.000000,1005.894717)
obs2[33,]<-c(640,2,1,192.441,1464.714,1.000000,965.606610)
obs2[34,]<-c(660,2,1,181.488,1347.794,0.989845,1006.695319)
obs2[35,]<-c(680,2,1,171.409,1481.659,1.000000,993.439857)
obs2[36,]<-c(700,2,1,166.896,1398.228,0.993960,984.757112)
obs2[37,]<-c(720,2,1,157.991,1214.343,0.989505,1026.38496)
obs2[38,]<-c(740,2,1,156.914,1430.355,1.000000,1009.665951)
obs2[39,]<-c(760,2,1,156.452,1352.688,0.999148,1005.537052)
obs2[40,]<-c(780,2,1,154.295,1315.957,0.985110,1023.178866)
obs2[41,]<-c(800,2,1,145.559,1479.661,0.989189,1002.350097)
obs2[42,]<-c(820,2,1,150.913,1290.633,0.981114,1008.794805)
obs2[43,]<-c(840,2,1,143.673,1694.123,1.000000,996.750320)
obs2[44,]<- c(1000,2,1,127.055,1518.733,0.996551,1010.118642)
obs2[45,]<-c(860,2,1,140.651,1487.769,0.984563,974.452864)
obs2[46,]<-c(880,2,1,135.251,1501.037,0.987382,1000.2771939)
obs2[47,]<-c(900,2,1,136.029,1440.570,0.993701,985.971266)
obs2[48,]<-c(920,2,1,138.349,1227.006,0.998446,1030.189764)
obs2[49,]<-c(940,2,1,133.074,1635.241,0.991286,1025.111832)
obs2[50,]<-c(960,2,1,136.406,1524.543,0.982640,995.477151)
obs2[51,]<-c(980,2,1,134.936,1545.449,1.000000,1007.366833)


write.table(round(obs2,3),paste0("/Users/Mac/Desktop/lec/hw1data2.txt"),quote = F,row.names = F,sep = "\t")




#doubling the access points from 2 to 4
obs3 <- matrix(nrow = 51,ncol = 7)
colnames(obs3)<-c("C","AP","S","thetha","PPS","CPS","d")



obs3[1,]<-c(1,4,1,0.980,3.804,0.000014,0.168766)
obs3[2,]<-c(20,4,1,19.882,108.279,0.000023,0.289326)
obs3[3,]<-c(40,4,1,39.569,201.483,0.000048,0.743366)
obs3[4,]<-c(60,4,1,59.614,326.931,0.000084,1.2271419)
obs3[5,]<-c(80,4,1,79.104,417.604,0.000132,3.605504)
obs3[6,]<-c(100,4,1,94.358,465.894,0.000236,4.878544)
obs3[7,]<-c(120,4,1,119.639,602.152,0.000500,14.785644)
obs3[8,]<-c(140,4,1,131.258,687.051,0.000922,21.704327)
obs3[9,]<-c(160,4,1,150.682,732.693,0.001753,49.163876)
obs3[10,]<-c(180,4,1,176.472,979.781,0.002510,93.396083)
obs3[11,]<-c(200,4,1,192.692,1105.392,0.004816,267.411433)
obs3[12,]<-c(220,4,1,219.030,1099.029,0.010635,612.774824)
obs3[13,]<-c(240,4,1,223.603,1170.999,0.015575,731.936273)
obs3[14,]<-c(260,4,1,244.148,1279.774,0.027789,896.660817)
obs3[15,]<-c(280,4,1,277.040,1292.108,0.062943,943.275594)
obs3[16,]<-c(300,4,1,280.008,1400.521,0.102926,980.430907)
obs3[17,]<-c(320,4,1,284.000,1691.402,0.115830,979.546262)
obs3[18,]<-c(340,4,1,272.596,1401.478,0.095833,984.893974)
obs3[19,]<-c(360,4,1,257.527,1434.759,0.059758,985.422362)
obs3[20,]<-c(380,4,1,238.237,1358.126,0.056367,1009.695739)
obs3[21,]<-c(400,4,1,233.304,1301.775,0.041697,1004.531749)
obs3[22,]<-c(420,4,1,219.648,1378.584,0.031560,995.394810)
obs3[23,]<-c(440,4,1,204.787,1232.428,0.031011,1031.489242)
obs3[24,]<-c(460,4,1,207.977,1217.048,0.032781,1003.061997)
obs3[25,]<-c(480,4,1,192.893,1121.645,0.026765,1014.002442)
obs3[26,]<-c(500,4,1,179.029,1113.786,0.026338,1004.434653)
obs3[27,]<-c(520,4,1,184.407,1434.039,0.024310,1004.672100)
obs3[28,]<-c(560,4,1,171.115,1227.563,0.023962,992.133434)
obs3[29,]<-c(540,4,1,171.199,1278.409,0.022802,976.540483)
obs3[30,]<-c(580,4,1,156.469,1285.463,0.024659,1030.912566)
obs3[31,]<-c(600,4,1,159.942,1306.057,0.022629,975.158078)
obs3[32,]<-c(620,4,1,144.725,1339.509,0.028199,1000.537930)
obs3[33,]<-c(640,4,1,141.001,1250.026,0.022202,981.354335)
obs3[34,]<-c(660,4,1,136.035,1227.657,0.022246,997.887547)
obs3[35,]<-c(680,4,1,138.801,1283.471,0.024989,997.358715)
obs3[36,]<-c(700,4,1,137.103,1243.941,0.023354,995.531789)
obs3[37,]<-c(720,4,1,124.139,1211.196,0.022227,999.870397)
obs3[38,]<-c(740,4,1,129.156,1315.708,0.025732,986.647003)
obs3[39,]<-c(760,4,1,118.995,1237.456,0.022307,1015.011539)
obs3[40,]<-c(780,4,1,122.455,1322.140,0.026552,986.243520)
obs3[41,]<-c(800,4,1,114.819,1317.564,0.025966,988.552994)
obs3[42,]<-c(820,4,1,110.895,1402.255,0.028016,1022.799633)
obs3[43,]<-c(840,4,1,111.057,1207.273,0.029665,1015.354724)
obs3[44,]<-c(1000,4,1,89.851,1362.976,0.048517,994.933273)
obs3[45,]<-c(860,4,1,111.001,1329.144,0.030212,989.707118)
obs3[46,]<-c(880,4,1,107.171,1249.352,0.034181,999.617037)
obs3[47,]<-c(900,4,1,104.625,1227.468,0.035428,989.261223)
obs3[48,]<-c(920,4,1,103.820,1352.031,0.038873,1014.404196)
obs3[49,]<-c(940,4,1,96.137,1394.731,0.045319,1025.483667)
obs3[50,]<-c(960,4,1,93.552,1381.121,0.037685,1004.976245)
obs3[51,]<-c(980,4,1,93.689,1162.461,0.052537,1001.175516)


write.table(round(obs3,3),paste0("/Users/Mac/Desktop/lec/hw1data3.txt"),quote = F,row.names = F,sep = "\t")


par(mfrow=c(2,2))

max_y <- max(y=obs1[,4], y=obs2[,4],y=obs3[,4])
plot(x=obs1[,1],y=obs1[,4],xlab= "C"
     ,ylab= "θ", ylim = c(0,max_y))
points(x=obs1[,1],y=obs2[,4],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.5)
points(x=obs1[,1],y=obs3[,4],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs4[,4],xlab= "C"
       ,ylab= "θ",col="black", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs5[,4],xlab= "C"
       ,ylab= "θ",col="green", pch = 10, cex = 0.5)

max_y <- max(y=obs1[,5], y=obs2[,5],y=obs3[,5])
plot(x=obs1[,1],y=obs1[,5],xlab= "C"
     ,ylab= "pps", ylim = c(0,max_y))
points(x=obs1[,1],y=obs2[,5],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.5)
points(x=obs1[,1],y=obs3[,5],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs4[,5],xlab= "C"
       ,ylab= "θ",col="black", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs5[,5],xlab= "C"
       ,ylab= "θ",col="green", pch = 10, cex = 0.5)


plot(x=obs1[,1],y=obs1[,6],xlab= "C"
     ,ylab= "cps",ylim = c(0,1.2),cex = 0.5)
points(x=obs1[,1],y=obs2[,6],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.5)
points(x=obs1[,1],y=obs3[,6],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs4[,6],xlab= "C"
       ,ylab= "θ",col="black", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs5[,6],xlab= "C"
       ,ylab= "θ",col="green", pch = 10, cex = 0.5)


max_y <- max(y=obs1[,7], y=obs2[,7],y=obs3[,7])

plot(x=obs1[,1],y=obs1[,7],xlab= "C",ylab= "d", ylim = c(0,max_y),cex = 0.5)
points(x=obs1[,1],y=obs2[,7],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.5)
points(x=obs1[,1],y=obs3[,7],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs4[,7],xlab= "C"
       ,ylab= "θ",col="black", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs5[,7],xlab= "C"
       ,ylab= "θ",col="green", pch = 10, cex = 0.5)



par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = 'l', bty = 'n', xaxt = 'n', yaxt = 'n')
legend(x = "top", inset=.02,ncol=3,cex=0.6,
       c('1','2','4'), fill=c("white", "blue","red"), title="number of access points")
