## 2

#Analyze the performance with AP = S = 1 by plotting the various performance metrics versus C.
#What can you conclude from there ?

obs1 <- matrix(nrow = 51,ncol = 7)
colnames(obs1)<-c("C","AP","S","thetha","PPS","CPS","d")

# now the runnings
#####
obs1[1,]<-c(1,1,1,0.943,0.000,0.000012,0.164462)
obs1[2,]<-c(20,1,1,19.656,121.847,0.000122,0.306908)
obs1[3,]<-c(40,1,1,37.791,200.370,0.001406,0.660043)
obs1[4,]<-c(60,1,1,56.447,308.063,0.016193,1.086610)
obs1[5,]<-c(80,1,1,79.502,392.983,0.170476,2.894217)
obs1[6,]<-c(100,1,1,98.866,539.276,0.871339,5.232287)
obs1[7,]<-c(120,1,1,111.300,658.594,0.987813,9.495328)
obs1[8,]<-c(140,1,1,118.156,586.092,0.999012,13.838694)
obs1[9,]<-c(160,1,1,129.240,791.792,1.000000,29.002573)
obs1[10,]<-c(180,1,1,133.939,728.338,1.000000,30.511928)
obs1[11,]<-c(200,1,1,133.585,706.830,0.991750,41.248431)
obs1[12,]<-c(220,1,1,146.443,769.809,1.000000,42.526359)
obs1[13,]<-c(240,1,1,150.754,794.134,0.996489,53.158862)
obs1[14,]<-c(260,1,1,157.844,950.241,0.998767,68.588788)
obs1[15,]<-c(280,1,1,153.511,933.054,1.000000,66.019821)
obs1[16,]<-c(300,1,1,165.437,981.702,1.000000,64.524297)
obs1[17,]<-c(320,1,1,173.371,987.742,0.986687,88.788742)
obs1[18,]<-c(340,1,1,174.394,1024.603,0.999391,94.435431)
obs1[19,]<-c(360,1,1,172.131,1154.250,0.995140,131.878098)
obs1[20,]<-c(380,1,1,183.883,943.936,1.000000,193.470679)
obs1[21,]<-c(400,1,1,184.969,1145.963,1.000000,193.470679)
obs1[22,]<-c(420,1,1,186.898,1157.995,1.000000,211.796123)
obs1[23,]<-c(440,1,1,189.828,1181.243,0.986004,175.931834)
obs1[24,]<-c(460,1,1,199.839,1346,0.995754,331.290513)
obs1[25,]<-c(480,1,1,203.333,1404.948,0.995754,331.290513)
obs1[26,]<-c(500,1,1,193.033,1375.209,1.000000,321.016293)
obs1[27,]<-c(520,1,1,206.430,1319.965,1.000000,334.437084)
obs1[28,]<-c(540,1,1,211.448,1399.715,1.000000,480.210134)
obs1[29,]<-c(560,1,1,204.182,1302.989,1.000000,477.517675)
obs1[30,]<-c(580,1,1,217.080,1627.332,1.000000,563.325721)
obs1[31,]<-c(600,1,1,206.732,1372.687,1.000000,605.723301)
obs1[32,]<-c(620,1,1,220.216,1314.058,1.000000,697.208547)
obs1[33,]<-c(640,1,1,221.821,1360.037,1.000000,602.113481)
obs1[34,]<-c(660,1,1,214.733,1635.937,1.000000,611.953827)
obs1[35,]<-c(680,1,1,219.375,1557.944,1.000000,702.335473)
obs1[36,]<-c(700,1,1,231.574,1648.185,1.000000,717.326775)
obs1[37,]<-c(720,1,1,236.663,1664.315,1.000000,818.139785)
obs1[38,]<-c(740,1,1,223.639,1656.161,1.000000,809.041196)
obs1[39,]<-c(760,1,1,241.190,1894.144,1.000000,802.286151)
obs1[40,]<-c(780,1,1,241.034,1885.008,0.995781,711.666381)
obs1[41,]<-c(800,1,1,229.420,1752.292,1.000000,862.010248)
obs1[42,]<-c(820,1,1,234.415,1688.597,0.982685,830.724984)
obs1[43,]<-c(840,1,1,245.579,1825.727,0.994525,847.842941)
obs1[44,]<- c(1000,1,1,254.959,2043.828,0.987302,924.518831)
obs1[45,]<-c(860,1,1,251.725,1857.840,0.995569,866.493007)
obs1[46,]<-c(880,1,1,242.164,1947.311,0.982454,898.371989)
obs1[47,]<-c(900,1,1,254.639,1943.957,0.997270,842.366062)
obs1[48,]<-c(920,1,1,255.573 ,2120.284,1.000000,944.158528)
obs1[49,]<-c(940,1,1,244.904,2054.047,1.000000,935.508509)
obs1[50,]<-c(960,1,1,249.680,1947.297,1.000000,896.969984)
obs1[51,]<-c(980,1,1,250.413,2191.486,1.000000,938.740258)


write.table(round(obs1,3),paste0("/Users/Mac/Desktop/lec/hw1data1.txt"),quote = F,row.names = F,sep = "\t")

##### first plots
par(mfrow=c(2,2))
plot(x=obs1[,1],y=obs1[,4],xlab= "C"
     ,ylab= "θ")
plot(x=obs1[,1],y=obs1[,5],xlab= "C"
     ,ylab= "pps")
plot(x=obs1[,1],y=obs1[,6],xlab= "C"
     ,ylab= "cps")
plot(x=obs1[,1],y=obs1[,7],xlab= "C"
     ,ylab= "d")

## 3

# Someone suggests to you that a solution is to double the number of access points. Pose this conclusion
# as a hypothesis and verify it by running other simulations.

#doubling the access points from 1 to 2 
obs2 <- matrix(nrow = 51,ncol = 7)
colnames(obs2)<-c("C","AP","S","thetha","PPS","CPS","d")



obs2[1,]<-c(1,2,1,0.963,0.021,0.000012,0.158247)
obs2[2,]<-c(20,2,1,18.853,127.793,0.000039,0.296879)
obs2[3,]<-c(40,2,1,38.897,235.981,0.000177,0.633365)
obs2[4,]<-c(60,2,1,59.005,251.683,0.000482,1.604239)
obs2[5,]<-c(80,2,1,77.861,394.295,0.001564,2.637980)
obs2[6,]<-c(100,2,1,93.637,526.486,0.005061,3.938962)
obs2[7,]<-c(120,2,1,112.894,508.536,0.013827,14.298952)
obs2[8,]<-c(140,2,1,135.443,802.637,0.060466,32.890445)
obs2[9,]<-c(160,2,1,158.858,738.536,0.212916,63.132478)
obs2[10,]<-c(180,2,1,172.402,912.077,0.584847,130.667456)
obs2[11,]<-c(200,2,1,190.508,980.415,0.881558,233.676899)
obs2[12,]<-c(220,2,1,205.432,1185.657,0.975630,482.814471)
obs2[13,]<-c(240,2,1,223.353,1145.602,0.987884,692.400490)
obs2[14,]<-c(260,2,1,227.594,1305.815,0.996361,775.415744)
obs2[15,]<-c(280,2,1,241.210,1328.970,1.000000,803.146628)
obs2[16,]<-c(300,2,1,247.188,1234.091,1.000000,839.129863)
obs2[17,]<-c(320,2,1,247.134,1305.868,1.000000,870.764805)
obs2[18,]<-c(340,2,1,249.669,1411.878,1.000000,877.660603)
obs2[19,]<-c(360,2,1,	271.794,1206.682,1.000000,930.439875)
obs2[20,]<-c(380,2,1,270.928,1562.016,0.990076,968.107125)
obs2[21,]<-c(400,2,1,272.644,1453.320,0.992784,920.022746)
obs2[22,]<-c(420,2,1,278.004,1739.301,0.971201,1003.323388)
obs2[23,]<-c(440,2,1,296.797,1509.565,0.984873,973.801653)
obs2[24,]<-c(460,2,1,302.659,1938.341,1.000000,947.967021)
obs2[25,]<-c(480,2,1,307.808,1581.289,0.994824,999.330648)
obs2[26,]<-c(500,2,1,276.305,1805.408,0.996864,966.442916)
obs2[27,]<-c(520,2,1,259.830,1710.114,1.000000,991.101662)
obs2[28,]<-c(540,2,1,234.882,1618.196,0.997398,975.960009)
obs2[29,]<-c(560,2,1,222.021,1645.483,1.000000,1029.790078)
obs2[30,]<-c(580,2,1,218.710,1414.138,1.000000,977.244579)
obs2[31,]<-c(600,2,1,208.689,1380.197,0.977080,1034.579190)
obs2[32,]<-c(620,2,1,186.894,1260.271,1.000000,1005.894717)
obs2[33,]<-c(640,2,1,192.441,1464.714,1.000000,965.606610)
obs2[34,]<-c(660,2,1,181.488,1347.794,0.989845,1006.695319)
obs2[35,]<-c(680,2,1,171.409,1481.659,1.000000,993.439857)
obs2[36,]<-c(700,2,1,166.896,1398.228,0.993960,984.757112)
obs2[37,]<-c(720,2,1,157.991,1214.343,0.989505,1026.38496)
obs2[38,]<-c(740,2,1,156.914,1430.355,1.000000,1009.665951)
obs2[39,]<-c(760,2,1,156.452,1352.688,0.999148,1005.537052)
obs2[40,]<-c(780,2,1,154.295,1315.957,0.985110,1023.178866)
obs2[41,]<-c(800,2,1,145.559,1479.661,0.989189,1002.350097)
obs2[42,]<-c(820,2,1,150.913,1290.633,0.981114,1008.794805)
obs2[43,]<-c(840,2,1,143.673,1694.123,1.000000,996.750320)
obs2[44,]<- c(1000,2,1,127.055,1518.733,0.996551,1010.118642)
obs2[45,]<-c(860,2,1,140.651,1487.769,0.984563,974.452864)
obs2[46,]<-c(880,2,1,135.251,1501.037,0.987382,1000.2771939)
obs2[47,]<-c(900,2,1,136.029,1440.570,0.993701,985.971266)
obs2[48,]<-c(920,2,1,138.349,1227.006,0.998446,1030.189764)
obs2[49,]<-c(940,2,1,133.074,1635.241,0.991286,1025.111832)
obs2[50,]<-c(960,2,1,136.406,1524.543,0.982640,995.477151)
obs2[51,]<-c(980,2,1,134.936,1545.449,1.000000,1007.366833)


write.table(round(obs2,3),paste0("/Users/Mac/Desktop/lec/hw1data2.txt"),quote = F,row.names = F,sep = "\t")




#doubling the access points from 2 to 4
obs3 <- matrix(nrow = 51,ncol = 7)
colnames(obs3)<-c("C","AP","S","thetha","PPS","CPS","d")



obs3[1,]<-c(1,4,1,0.980,3.804,0.000014,0.168766)
obs3[2,]<-c(20,4,1,19.882,108.279,0.000023,0.289326)
obs3[3,]<-c(40,4,1,39.569,201.483,0.000048,0.743366)
obs3[4,]<-c(60,4,1,59.614,326.931,0.000084,1.2271419)
obs3[5,]<-c(80,4,1,79.104,417.604,0.000132,3.605504)
obs3[6,]<-c(100,4,1,94.358,465.894,0.000236,4.878544)
obs3[7,]<-c(120,4,1,119.639,602.152,0.000500,14.785644)
obs3[8,]<-c(140,4,1,131.258,687.051,0.000922,21.704327)
obs3[9,]<-c(160,4,1,150.682,732.693,0.001753,49.163876)
obs3[10,]<-c(180,4,1,176.472,979.781,0.002510,93.396083)
obs3[11,]<-c(200,4,1,192.692,1105.392,0.004816,267.411433)
obs3[12,]<-c(220,4,1,219.030,1099.029,0.010635,612.774824)
obs3[13,]<-c(240,4,1,223.603,1170.999,0.015575,731.936273)
obs3[14,]<-c(260,4,1,244.148,1279.774,0.027789,896.660817)
obs3[15,]<-c(280,4,1,277.040,1292.108,0.062943,943.275594)
obs3[16,]<-c(300,4,1,280.008,1400.521,0.102926,980.430907)
obs3[17,]<-c(320,4,1,284.000,1691.402,0.115830,979.546262)
obs3[18,]<-c(340,4,1,272.596,1401.478,0.095833,984.893974)
obs3[19,]<-c(360,4,1,257.527,1434.759,0.059758,985.422362)
obs3[20,]<-c(380,4,1,238.237,1358.126,0.056367,1009.695739)
obs3[21,]<-c(400,4,1,233.304,1301.775,0.041697,1004.531749)
obs3[22,]<-c(420,4,1,219.648,1378.584,0.031560,995.394810)
obs3[23,]<-c(440,4,1,204.787,1232.428,0.031011,1031.489242)
obs3[24,]<-c(460,4,1,207.977,1217.048,0.032781,1003.061997)
obs3[25,]<-c(480,4,1,192.893,1121.645,0.026765,1014.002442)
obs3[26,]<-c(500,4,1,179.029,1113.786,0.026338,1004.434653)
obs3[27,]<-c(520,4,1,184.407,1434.039,0.024310,1004.672100)
obs3[28,]<-c(560,4,1,171.115,1227.563,0.023962,992.133434)
obs3[29,]<-c(540,4,1,171.199,1278.409,0.022802,976.540483)
obs3[30,]<-c(580,4,1,156.469,1285.463,0.024659,1030.912566)
obs3[31,]<-c(600,4,1,159.942,1306.057,0.022629,975.158078)
obs3[32,]<-c(620,4,1,144.725,1339.509,0.028199,1000.537930)
obs3[33,]<-c(640,4,1,141.001,1250.026,0.022202,981.354335)
obs3[34,]<-c(660,4,1,136.035,1227.657,0.022246,997.887547)
obs3[35,]<-c(680,4,1,138.801,1283.471,0.024989,997.358715)
obs3[36,]<-c(700,4,1,137.103,1243.941,0.023354,995.531789)
obs3[37,]<-c(720,4,1,124.139,1211.196,0.022227,999.870397)
obs3[38,]<-c(740,4,1,129.156,1315.708,0.025732,986.647003)
obs3[39,]<-c(760,4,1,118.995,1237.456,0.022307,1015.011539)
obs3[40,]<-c(780,4,1,122.455,1322.140,0.026552,986.243520)
obs3[41,]<-c(800,4,1,114.819,1317.564,0.025966,988.552994)
obs3[42,]<-c(820,4,1,110.895,1402.255,0.028016,1022.799633)
obs3[43,]<-c(840,4,1,111.057,1207.273,0.029665,1015.354724)
obs3[44,]<-c(1000,4,1,89.851,1362.976,0.048517,994.933273)
obs3[45,]<-c(860,4,1,111.001,1329.144,0.030212,989.707118)
obs3[46,]<-c(880,4,1,107.171,1249.352,0.034181,999.617037)
obs3[47,]<-c(900,4,1,104.625,1227.468,0.035428,989.261223)
obs3[48,]<-c(920,4,1,103.820,1352.031,0.038873,1014.404196)
obs3[49,]<-c(940,4,1,96.137,1394.731,0.045319,1025.483667)
obs3[50,]<-c(960,4,1,93.552,1381.121,0.037685,1004.976245)
obs3[51,]<-c(980,4,1,93.689,1162.461,0.052537,1001.175516)


write.table(round(obs3,3),paste0("/Users/Mac/Desktop/lec/hw1data3.txt"),quote = F,row.names = F,sep = "\t")


#doubling the access points from 4 to 8
obs4 <- matrix(nrow = 51,ncol = 7)
colnames(obs4)<-c("C","AP","S","thetha","PPS","CPS","d")



obs4[1,]<-c(1,8,1,0.955,5.192,0.000015,0.171022)
obs4[2,]<-c(20,8,1,19.411,103.577,0.000016,0.357365)
obs4[3,]<-c(40,8,1,39.852,198.173,0.000024,0.554460)
obs4[4,]<-c(60,8,1,56.497,268.121,0.000034,1.201544)
obs4[5,]<-c(80,8,1,75.582,289.378,0.000039,3.216048)
obs4[6,]<-c(100,8,1,97.634,553.224,0.000058,9.018933)
obs4[7,]<-c(120,8,1,118.446,626.054,0.000089,14.636775)
obs4[8,]<-c(140,8,1,134.365,836.028,0.000114,33.298875)
obs4[9,]<-c(180,8,1,176.270,863.459,0.000166,112.815598)
obs4[10,]<-c(160,8,1,155.016,739.390,0.000143,70.838955)
obs4[11,]<-c(200,8,1,187.722,886.382,0.000276,255.155494)
obs4[12,]<-c(220,8,1,211.083,1080.474,0.000296,472.496434)
obs4[13,]<-c(240,8,1,237.379,1293.660,0.000558,747.725391)
obs4[14,]<-c(260,8,1,246.386,1297.071,0.000746,917.608153)
obs4[15,]<-c(280,8,1,269.200,1417.662,0.000881,928.864271)
obs4[16,]<-c(300,8,1,295.401,1597.469,0.001036,979.296724)
obs4[17,]<-c(320,8,1,296.234,1448.419,0.001142,995.936000)
obs4[18,]<-c(340,8,1,267.056,1492.500,0.001345,970.755505)
obs4[19,]<-c(360,8,1,260.330,1416.699,0.000835,990.949556)
obs4[20,]<-c(380,8,1,238.237,1305.638,0.000800,1032.191962)
obs4[21,]<-c(400,8,1,233.372,1314.338,0.000712,1040.876690)
obs4[22,]<-c(420,8,1,224.885,1205.344,0.000705,1016.835652)
obs4[23,]<-c(440,8,1,212.844,1373.701,0.000701,	981.231022)
obs4[24,]<-c(460,8,1,200.387,1302.769,0.000537,1012.523998)
obs4[25,]<-c(480,8,1,196.565,1316.915,0.000643,1006.201847)
obs4[26,]<-c(500 ,8,1,184.948,1295.058,0.000577,1015.245738)
obs4[27,]<-c(520 ,8,1,178.521,1320.216,0.000615,1009.996745)
obs4[28,]<-c(560,8,1,163.391,1265.590,0.000597,1021.164881)
obs4[29,]<-c(540,8,1,167.324,1138.045,0.000502,1012.317437)
obs4[30,]<-c(580,8,1,155.936,1202.917,0.000485,1009.805397)
obs4[31,]<-c(600,8,1,156.299,1339.466,0.000543,1020.435047)
obs4[32,]<-c(620,8,1,147.416,1313.333,0.000556,996.138243)
obs4[33,]<-c(640,8,1,148.548,1267.283,0.000601,1025.563677)
obs4[34,]<-c(660,8,1,141.549,1208.105,0.000543,999.567648)
obs4[35,]<-c(680,8,1,138.930,1253.077,0.000545,1026.840781)
obs4[36,]<-c(700,8,1,136.776,1276.037,0.000558,995.545727)
obs4[37,]<-c(720,8,1,126.362,1382.044,0.000682,1005.198398)
obs4[38,]<-c(740,8,1,128.129,1092.705,0.000535,967.871709)
obs4[39,]<-c(760,8,1,123.996,1233.413,0.000496,1001.935531)
obs4[40,]<-c(780,8,1,115.978,1200.225,0.000628,1010.107671)
obs4[41,]<-c(800,8,1,114.012,1201.612,0.000588,1019.377052)
obs4[42,]<-c(820,8,1,116.170,1370.807,0.000619,994.369824)
obs4[43,]<-c(840,8,1,113.396,1223.162,0.000585,1009.113006)
obs4[44,]<-c(1000,8,1,90.530,1416.819,0.000934,1031.600385)
obs4[45,]<-c(860,8,1,106.644,1291.966,0.000660,988.689759)
obs4[46,]<-c(880,8,1,102.378,1210.523,0.000645,1004.548219)
obs4[47,]<-c(900,8,1,100.492,1215.528,0.000833,991.605846)
obs4[48,]<-c(920,8,1,104.062,1380.054,0.000638,1007.586998)
obs4[49,]<-c(940,8,1,99.543,1317.731,0.000665,995.580926)
obs4[50,]<-c(960,8,1,96.439,1421.120,0.000805,976.531114)
obs4[51,]<-c(980,8,1,97.011,1451.478,0.000886,997.860985)


write.table(round(obs4,3),paste0("/Users/Mac/Desktop/lec/hw1data4.txt"),quote = F,row.names = F,sep = "\t")



#doubling the access points from 8 to 10
obs5 <- matrix(nrow = 51,ncol = 7)
colnames(obs5)<-c("C","AP","S","thetha","PPS","CPS","d")



obs5[1,]<-c(1,10,1,0.954,4.379,0.000012,0.117527)
obs5[2,]<-c(20,10,1,19.734,121.418,0.000015,0.331365)
obs5[3,]<-c(40,10,1,37.861,190.247,0.000021,0.481309)
obs5[4,]<-c(60,10,1,58.425,204.159,0.000022,1.100893)
obs5[5,]<-c(80,10,1,79.770,375.465,0.000032,3.484559)
obs5[6,]<-c(100,10,1,99.489,437.844,0.000040,6.851337)
obs5[7,]<-c(120,10,1,118.950,576.646,0.000050,13.640867)
obs5[8,]<-c(140,10,1,133.395,754.453,0.000082,27.648058)
obs5[9,]<-c(180,10,1,176.560,844.271,0.000121,86.207952)
obs5[10,]<-c(160,10,1,157.245,850.060,0.000067,45.775386)
obs5[11,]<-c(200,10,1,190.746,1011.848,0.000140,291.110874)
obs5[12,]<-c(220,10,1,206.263,1179.998,0.000191,497.638351)
obs5[13,]<-c(240,10,1,239.748,1062.970,0.000232,749.091352)
obs5[14,]<-c(260,10,1,249.972,1263.779,0.000240,848.332951)
obs5[15,]<-c(280,10,1,268.475,1492.901,0.000385,905.834069)
obs5[16,]<-c(300,10,1,280.743,1562.151,0.000464,943.208004)
obs5[17,]<-c(320,10,1,285.660,1451.826,0.000527,948.949170)
obs5[18,]<-c(340,10,1,265.671,1420.357,0.000388,985.240754)
obs5[19,]<-c(360,10,1,257.639,1435.752,0.000428,995.523845)
obs5[20,]<-c(380,10,1,251.656,1475.221,0.000366,995.199174)
obs5[21,]<-c(400,10,1,238.837,1381.869,0.000351,1002.906046)
obs5[22,]<-c(420,10,1,226.023,1332.610,0.000256,1024.690332)
obs5[23,]<-c(440,10,1,210.734,1333.966,0.000254,1037.571381)
obs5[24,]<-c(460,10,1,194.523,1269.844,0.000316,1013.735565)
obs5[25,]<-c(480,10,1,199.690,1187.899,0.000286,1038.641716)
obs5[26,]<-c(500,10,1,186.065,1433.255,0.000270,1019.895866)
obs5[27,]<-c(520,10,1,179.982,1335.132,0.000216,1003.055250)
obs5[28,]<-c(560,10,1,161.228,1301.896,0.000299,1002.646327)
obs5[29,]<-c(540,10,1,170.962,1231.112,0.000271,1021.150407)
obs5[30,]<-c(580,10,1,156.353,1116.653,0.000232,1011.462184)
obs5[31,]<-c(600,10,1,155.985,1185.585,0.000223,1011.616537)
obs5[32,]<-c(620,10,1,146.743,1270.220,0.000255,1011.916497)
obs5[33,]<-c(640,10,1,145.668,1244.276,0.000257,998.745308)
obs5[34,]<-c(660,10,1,138.798,1203.118,0.000250,1016.880434)
obs5[35,]<-c(680,10,1,136.625,1311.332,0.000321,1003.019614)
obs5[36,]<-c(700,10,1,132.164,1218.779,0.000315,1000.953613)
obs5[37,]<-c(720,10,1,127.820,1476.819,0.000243,992.264700)
obs5[38,]<-c(740,10,1,122.247,1174.091,0.000275,1003.082333)
obs5[39,]<-c(760,10,1,123.827,1296.654,0.000286,1019.320873)
obs5[40,]<-c(780,10,1,121.937,1319.594,0.000261,1026.9424261)
obs5[41,]<-c(800,10,1,112.742,1211.776,0.000277,1009.633415)
obs5[42,]<-c(820,10,1,116.957,1337.828,0.000275,980.293792)
obs5[43,]<-c(840,10,1,106.525,1157.828,0.000271,969.315352)
obs5[44,]<-c(1000,10,1,90.456,1305.186,0.000364,1017.896852)
obs5[45,]<-c(860,10,1,107.082,1411.200,0.000292,1013.406777)
obs5[46,]<-c(880,10,1,102.164,1242.148,0.000341,986.319370)
obs5[47,]<-c(900,10,1,103.287,1403.821,0.000257,989.342175)
obs5[48,]<-c(920,10,1,98.059,1417.310,0.000319,1014.376493)
obs5[49,]<-c(940,10,1,98.842,1339.455,0.000358,1000.000000)
obs5[50,]<-c(960,10,1,95.900,1518.140,0.000401,1007.159015)
obs5[51,]<-c(980,10,1,96.963,1385.916,0.000360,985.744694)


write.table(round(obs5,3),paste0("/Users/Mac/Desktop/lec/hw1data5.txt"),quote = F,row.names = F,sep = "\t")




##### SECOND plots
par(mfrow=c(2,2))

max_y <- max(y=obs1[,4], y=obs2[,4],y=obs3[,4],y=obs4[,4],y=obs5[,4])
plot(x=obs1[,1],y=obs1[,4],xlab= "C"
     ,ylab= "θ", ylim = c(0,max_y))
points(x=obs1[,1],y=obs2[,4],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.5)
points(x=obs1[,1],y=obs3[,4],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs4[,4],xlab= "C"
       ,ylab= "θ",col="black", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs5[,4],xlab= "C"
       ,ylab= "θ",col="green", pch = 10, cex = 0.5)

max_y <- max(y=obs1[,5], y=obs2[,5],y=obs3[,5],y=obs4[,5],y=obs5[,5])
plot(x=obs1[,1],y=obs1[,5],xlab= "C"
     ,ylab= "pps", ylim = c(0,max_y))
points(x=obs1[,1],y=obs2[,5],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.5)
points(x=obs1[,1],y=obs3[,5],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs4[,5],xlab= "C"
       ,ylab= "θ",col="black", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs5[,5],xlab= "C"
       ,ylab= "θ",col="green", pch = 10, cex = 0.5)


plot(x=obs1[,1],y=obs1[,6],xlab= "C"
     ,ylab= "cps",ylim = c(0,1.2))
points(x=obs1[,1],y=obs2[,6],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.5)
points(x=obs1[,1],y=obs3[,6],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs4[,6],xlab= "C"
       ,ylab= "θ",col="black", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs5[,6],xlab= "C"
       ,ylab= "θ",col="green", pch = 10, cex = 0.5)


max_y <- max(y=obs1[,7], y=obs2[,7],y=obs3[,7],y=obs4[,7],y=obs5[,7])

plot(x=obs1[,1],y=obs1[,7],xlab= "C",ylab= "d", ylim = c(0,max_y))
points(x=obs1[,1],y=obs2[,7],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.5)
points(x=obs1[,1],y=obs3[,7],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs4[,7],xlab= "C"
       ,ylab= "θ",col="black", pch = 10, cex = 0.5)
points(x=obs1[,1],y=obs5[,7],xlab= "C"
       ,ylab= "θ",col="green", pch = 10, cex = 0.5)



par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = 'l', bty = 'n', xaxt = 'n', yaxt = 'n')
legend(x = "top", inset=.02,ncol=5,cex=0.5,
   c('1','2','4','8','10'), fill=c("white", "blue","red", "black","green", "purple"), title="number of access points")


######     is doubling a good idea ? / trying to find an engineering rule


#by doubling access points, it will reduce the collision probability. Doubling the number of access points results in 
#more succesfull download requests for smaller values C (peaks at 500) but seems to be less efficient for 
#larger number requests. This peaking pattern can also be seen while measuring the pps. For delays, less
#servers seem to be more optimal since the scatterplot is convex/flatter.

#one rule can that when there's less than let's say 500 requests, have more servers. Once we go pass the threshold
# (500), we shut some servers. 

#Still problem with the collision 

# aussi le coté linéaire !! try to identify as a function of the number of requests per second, C,
#what should be the number of servers, S, and access points, AP, such that there is a linear growth in
#the throughput


#with data i have already

obs6 <- matrix(nrow = 51,ncol = 7)
colnames(obs6)<-c("C","AP","S","thetha","PPS","CPS","d")

# now the runnings
#####
obs6[1,]<-c(1,10,1,0.954,4.379,0.000012,0.117527)
obs6[2,]<-c(20,10,1,19.734,121.418,0.000015,0.331365)
obs6[3,]<-c(40,10,1,37.861,190.247,0.000021,0.481309)
obs6[4,]<-c(60,10,1,58.425,204.159,0.000022,1.100893)
obs6[5,]<-c(80,10,1,79.770,375.465,0.000032,3.484559)
obs6[6,]<-c(100,10,1,99.489,437.844,0.000040,6.851337)
obs6[7,]<-c(120,10,1,118.950,576.646,0.000050,13.640867)
obs6[8,]<-c(140,10,1,133.395,754.453,0.000082,27.648058)
obs6[9,]<-c(180,10,1,176.560,844.271,0.000121,86.207952)
obs6[10,]<-c(160,10,1,157.245,850.060,0.000067,45.775386)
obs6[11,]<-c(200,10,1,190.746,1011.848,0.000140,291.110874)
obs6[12,]<-c(220,10,1,206.263,1179.998,0.000191,497.638351)
obs6[13,]<-c(240,10,1,239.748,1062.970,0.000232,749.091352)
obs6[14,]<-c(260,10,1,249.972,1263.779,0.000240,848.332951)
obs6[15,]<-c(280,10,1,268.475,1492.901,0.000385,905.834069)
obs6[16,]<-c(300,10,1,280.743,1562.151,0.000464,943.208004)
obs6[17,]<-c(320,10,1,285.660,1451.826,0.000527,948.949170)
obs6[18,]<-c(340,2,1,249.669,1411.878,1.000000,877.660603)
obs6[19,]<-c(360,2,1,	271.794,1206.682,1.000000,930.439875)
obs6[20,]<-c(380,2,1,270.928,1562.016,0.990076,968.107125)
obs6[21,]<-c(400,2,1,272.644,1453.320,0.992784,920.022746)
obs6[22,]<-c(420,2,1,278.004,1739.301,0.971201,1003.323388)
obs6[23,]<-c(440,2,1,296.797,1509.565,0.984873,973.801653)
obs6[24,]<-c(460,10,1,194.523,1269.844,0.000316,1013.735565)
obs6[25,]<-c(480,10,1,199.690,1187.899,0.000286,1038.641716)
obs6[26,]<-c(500,10,1,186.065,1433.255,0.000270,1019.895866)
obs6[27,]<-c(520,1,1,206.430,1319.965,1.000000,334.437084)
obs6[28,]<-c(540,1,1,211.448,1399.715,1.000000,480.210134)
obs6[29,]<-c(560,1,1,204.182,1302.989,1.000000,477.517675)
obs6[30,]<-c(580,1,1,217.080,1627.332,1.000000,563.325721)
obs6[31,]<-c(600,1,1,206.732,1372.687,1.000000,605.723301)
obs6[32,]<-c(620,1,1,220.216,1314.058,1.000000,697.208547)
obs6[33,]<-c(640,1,1,221.821,1360.037,1.000000,602.113481)
obs6[34,]<-c(660,1,1,214.733,1635.937,1.000000,611.953827)
obs6[35,]<-c(680,1,1,219.375,1557.944,1.000000,702.335473)
obs6[36,]<-c(700,1,1,231.574,1648.185,1.000000,717.326775)
obs6[37,]<-c(720,1,1,236.663,1664.315,1.000000,818.139785)
obs6[38,]<-c(740,1,1,223.639,1656.161,1.000000,809.041196)
obs6[39,]<-c(760,1,1,241.190,1894.144,1.000000,802.286151)
obs6[40,]<-c(780,1,1,241.034,1885.008,0.995781,711.666381)
obs6[41,]<-c(800,1,1,229.420,1752.292,1.000000,862.010248)
obs6[42,]<-c(820,1,1,234.415,1688.597,0.982685,830.724984)
obs6[43,]<-c(840,1,1,245.579,1825.727,0.994525,847.842941)
obs6[44,]<- c(1000,1,1,254.959,2043.828,0.987302,924.518831)
obs6[45,]<-c(860,1,1,251.725,1857.840,0.995569,866.493007)
obs6[46,]<-c(880,1,1,242.164,1947.311,0.982454,898.371989)
obs6[47,]<-c(900,1,1,254.639,1943.957,0.997270,842.366062)
obs6[48,]<-c(920,1,1,255.573 ,2120.284,1.000000,944.158528)
obs6[49,]<-c(940,1,1,244.904,2054.047,1.000000,935.508509)
obs6[50,]<-c(960,1,1,249.680,1947.297,1.000000,896.969984)
obs6[51,]<-c(980,1,1,250.413,2191.486,1.000000,938.740258)

write.table(round(obs6,3),paste0("/Users/Mac/Desktop/lec/hw1data6.txt"),quote = F,row.names = F,sep = "\t")


par(mfrow=c(2,2))

max_y <- max(y=obs1[,4], y=obs6[,4])
plot(x=obs1[,1],y=obs6[,4],xlab= "C"
     ,ylab= "θ", ylim = c(0,max_y))

max_y <- max(y=obs1[,5], y=obs6[,5])
plot(x=obs1[,1],y=obs6[,5],xlab= "C"
     ,ylab= "θ", ylim = c(0,max_y))

max_y <- max(y=obs1[,6], y=obs6[,6])
plot(x=obs1[,1],y=obs6[,6],xlab= "C"
     ,ylab= "θ", ylim = c(0,max_y))


max_y <- max(y=obs1[,7], y=obs6[,7])
plot(x=obs1[,1],y=obs6[,7],xlab= "C"
     ,ylab= "θ", ylim = c(0,max_y))


#now trying to move the number of servers randomly to see the effect
# for this we will be trying with values of C over and under 500: 1, 250, 500, 750,1000
#for access points we take: 1,5,10
# and vary the number of servers: 1, 3,5,7,10


obs7 <- matrix(nrow = 75,ncol = 7)
colnames(obs7)<-c("C","AP","S","thetha","PPS","CPS","d")


#pour S = 1
obs7[1,]<-c(1,1,1,0.949,4.379,0.000015,0.136878)
obs7[2,]<-c(500,1,1,193,1273,1,385)
obs7[3,]<-c(250,1,1,155,893,1,54)
obs7[4,]<-c(750,1,1,227,1687,0.99,766)
obs7[5,]<-c(1000,1,1,263,1959,0.98,919.88)

obs7[6,]<-c(250,5,1,233,1186,0,852)
obs7[7,]<-c(1,5,1,0.96,6.495,0.000013,0.172463)
obs7[8,]<-c(500,5,1,183,1323,0,1004)
obs7[9,]<-c(750,5,1,123,1066,0,1004)
obs7[10,]<-c(1000,5,1,93,1368,0,983.6)

obs7[11,]<-c(1,10,1,0.948,15.009,0.000013,0.103294)
obs7[12,]<-c(250,10,1,236,1251,0,879)
obs7[13,]<-c(500,10,1,182,1255,0,984)
obs7[14,]<-c(750,10,1,125,1296,0,969.9)
obs7[15,]<- c(1000,10,1,92.810,1425,0,1023)


par(mfrow=c(2,2))

max_y <- max(y=obs7[(1:15),4])

plot(x=obs7[(1:5),1],y=obs7[(1:5),4],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(6:10),1],y=obs7[(6:10),4],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(11:15),4],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))


max_y <- max(y=obs7[(1:15),5])

plot(x=obs7[(1:5),1],y=obs7[(1:5),5],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(6:10),1],y=obs7[(6:10),5],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(11:15),5],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))

max_y <- max(y=obs7[(1:15),6])

plot(x=obs7[(1:5),1],y=obs7[(1:5),6],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(6:10),1],y=obs7[(6:10),6],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(11:15),6],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))

max_y <- max(y=obs7[(1:15),7])

plot(x=obs7[(1:5),1],y=obs7[(1:5),7],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(6:10),1],y=obs7[(6:10),7],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(11:15),7],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))


par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = 'l', bty = 'n', xaxt = 'n', yaxt = 'n')
legend(x = "top", inset=.02,ncol=3,cex=0.5,
       c('1','5','10'), fill=c("white", "blue","red"), title="For S=1: number of access points")



#pour S=3

obs7[16,]<-c(1,1,3,0.973,0.000,0.000016,0.166148)
obs7[17,]<-c(250,1,3,154,939,1,19)
obs7[18,]<-c(500,1,3,204,1319,1,2.48)
obs7[19,]<-c(750,1,3,228,1679,1,2.73)
obs7[20,]<-c(1000,1,3,263.8,1890,1,5.85)

obs7[21,]<-c(1,5,3,0.935,6.034,0.000013,0.128128)
obs7[22,]<-c(500,5,3,495,2494,0.84,83.42)
obs7[23,]<-c(750,5,3,618,3255,1,375)
obs7[24,]<-c(1000,5,3,688,3925,0.98,696)
obs7[25,]<-c(250,5,3,238,1236,0,3.6)

obs7[26,]<-c(1,10,3,0.969,9.142,9.142,9.142)
obs7[27,]<-c(250,10,3,247,1222,0,3.48)
obs7[28,]<-c(500,10,3,465,2305,0,68.58)
obs7[29,]<-c(750,10,3,717,3820,0.1,841.5)
obs7[30,]<-c(1000,10,3,836,4325,0.57,1010)


par(mfrow=c(2,2))

max_y <- max(y=obs7[(16:30),4])

plot(x=obs7[(16:20),1],y=obs7[(16:20),4],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(21:25),4],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(26:30),4],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))


max_y <- max(y=obs7[(16:30),5])

plot(x=obs7[(1:5),1],y=obs7[(16:20),5],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(6:10),1],y=obs7[(21:25),5],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(26:30),5],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))

max_y <- max(y=obs7[(16:30),6])

plot(x=obs7[(1:5),1],y=obs7[(16:20),6],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(6:10),1],y=obs7[(21:25),6],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(26:30),6],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))

max_y <- max(y=obs7[(16:30),7])

plot(x=obs7[(1:5),1],y=obs7[(16:20),7],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(6:10),1],y=obs7[(21:25),7],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(26:30),7],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))


par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = 'l', bty = 'n', xaxt = 'n', yaxt = 'n')
legend(x = "top", inset=.02,ncol=3,cex=0.5,
       c('1','5','10'), fill=c("white", "blue","red"), title="For S=3: number of access points")



#pour S=5

obs7[31,]<-c(1,1,5,0.933,0.189,0.000014,0.089035)
obs7[32,]<-c(250,1,5,153,948,1,0.36)
obs7[33,]<-c(500,1,5,201,1208,1,0.73)
obs7[34,]<-c(750,1,5,234,1686,1,0.97)
obs7[35,]<-c(1000,1,5,255,2187,1,1)

obs7[36,]<-c(1,5,5,0.986,0.640,0.000013,0.129322)
obs7[38,]<-c(250,5,5,240,1209,0,1.19)
obs7[37,]<-c(500,5,5,470,2455,0/87,5.07)
obs7[40,]<-c(750,5,5,602,3349,1,21.3)
obs7[39,]<-c(1000,5,5,695,4068,1,23.23)

obs7[41,]<-c(1,10,5,0.976,1.791,0.000012,0.119298)
obs7[42,]<-c(250,10,5,240,1209,0,1.2)
obs7[43,]<-c(500,10,5,496,2283,0.00,6.28)
obs7[44,]<-c(750,10,5,698,3643,0.12,38)
obs7[45,]<-c(1000,10,5,969,4823,0.86,276)


par(mfrow=c(2,2))

max_y <- max(y=obs7[(31:45),4])

plot(x=obs7[(16:20),1],y=obs7[(31:35),4],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(36:40),4],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(41:45),4],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))


max_y <- max(y=obs7[(31:45),5])

plot(x=obs7[(16:20),1],y=obs7[(31:35),5],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(36:40),5],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(41:45),5],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))

max_y <- max(y=obs7[(31:45),6])

plot(x=obs7[(16:20),1],y=obs7[(31:35),6],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(36:40),6],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(41:45),6],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))

max_y <- max(y=obs7[(31:45),7])

plot(x=obs7[(16:20),1],y=obs7[(31:35),7],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(36:40),7],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(41:45),7],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))


par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = 'l', bty = 'n', xaxt = 'n', yaxt = 'n')
legend(x = "top", inset=.02,ncol=3,cex=0.5,
       c('1','5','10'), fill=c("white", "blue","red"), title="For S=5: number of access points")

#pour S=7

obs7[46,]<-c(1,1,7,0.993,0.000,0.000015,0.144586)
obs7[47,]<-c(250,1,7,150.8,900.9,0.99,0.34)
obs7[48,]<-c(500,1,7,194,1307,1,0.47)
obs7[50,]<-c(750,1,7,231,1754,1,0.4)
obs7[49,]<-c(1000,1,7,248,1848,0.98,0.63)

obs7[51,]<-c(1,5,7,0.953,5.195,0.000014,0.185879)
obs7[52,]<-c(250,5,7,235,1127,0,0.6)
obs7[53,]<-c(500,5,7,486.4,2501,0.89,1.92)
obs7[54,]<-c(750,5,7,600,3270,1,4.22)
obs7[55,]<-c(1000,5,7,668,3814,0.99,5.9)


obs7[56,]<-c(1,10,7,0.949,7.009,0.000014,0.093006)
obs7[57,]<-c(250,10,7,246,1188,0,0.66)
obs7[58,]<-c(500,10,7,497,2410,0.004,2.4)
obs7[59,]<-c(750,10,7,699,4103,0.09,10)
obs7[60,]<-c(1000,10,7,956,5226,0.88,31.29)


par(mfrow=c(2,2))

max_y <- max(y=obs7[(46:60),4])

plot(x=obs7[(16:20),1],y=obs7[(46:50),4],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(51:55),4],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(56:60),4],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))


max_y <- max(y=obs7[(46:60),5])

plot(x=obs7[(16:20),1],y=obs7[(46:50),5],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(51:55),5],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(56:60),5],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))


max_y <- max(y=obs7[(46:60),6])

plot(x=obs7[(16:20),1],y=obs7[(46:50),6],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(51:55),6],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(56:60),6],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))

max_y <- max(y=obs7[(46:60),7])

plot(x=obs7[(16:20),1],y=obs7[(46:50),7],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(51:55),7],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(56:60),7],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))


par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = 'l', bty = 'n', xaxt = 'n', yaxt = 'n')
legend(x = "top", inset=.02,ncol=3,cex=0.5,
       c('1','5','10'), fill=c("white", "blue","red"), title="For S=7: number of access points")


#pour S=10
obs7[61,]<-c(1,1,10,0.966,8.000,0.000012,0.102612)
obs7[62,]<-c(250,1,10,156.6,889.585,1,0.244)
obs7[63,]<-c(500,1,10,196,1338,1,0.34)
obs7[64,]<-c(750,1,10,228,1574,1,0.28)
obs7[65,]<-c(1000,1,10,262,2178,0.98,0.4)

obs7[66,]<-c(1,5,10,0.931,9.486,0.000012,0.161823)
obs7[67,]<-c(250,5,10,247.637,1060.4,0.046,0.5429)
obs7[68,]<-c(500,5,10,482,2512,0.86,0.92)
obs7[69,]<-c(750,5,10,613,3505,1,1.58)
obs7[70,]<-c(1000,5,10,674.817,3903,0.99,2.05)

obs7[71,]<-c(1,10,10,0.996,2.516,0.000013,0.135941)
obs7[72,]<-c(250,10,10,248.792,1240.439,0.000246,0.469579)
obs7[73,]<-c(500,10,10,472,2471,0,0.95)
obs7[74,]<-c(750,10,10,702.173,3778.3,0.1,2.14)
obs7[75,]<-c(1000,10,10,966,5071,0.88,2.27)


par(mfrow=c(2,2))

max_y <- max(y=obs7[(61:75),4])

plot(x=obs7[(16:20),1],y=obs7[(61:65),4],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(66:70),4],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(71:75),4],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))

max_y <- max(y=obs7[(61:75),5])

plot(x=obs7[(16:20),1],y=obs7[(61:65),5],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(66:70),5],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(71:75),5],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))

max_y <- max(y=obs7[(61:75),6])

plot(x=obs7[(16:20),1],y=obs7[(61:65),6],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(66:70),6],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(71:75),6],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))


max_y <- max(y=obs7[(61:75),7])

plot(x=obs7[(16:20),1],y=obs7[(61:65),7],xlab= "C" ,ylab= "θ",ylim = c(0,max_y))
points(x=obs7[(16:20),1],y=obs7[(66:70),7],xlab= "C"
       ,ylab= "θ",col="blue", pch = 19, cex = 0.75,ylim = c(0,max_y))
points(x=obs7[(11:15),1],y=obs7[(71:75),7],xlab= "C"
       ,ylab= "θ",col="red", pch = 10, cex = 0.5,ylim = c(0,max_y))


par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = 'l', bty = 'n', xaxt = 'n', yaxt = 'n')
legend(x = "top", inset=.02,ncol=3,cex=0.5,
       c('1','5','10'), fill=c("white", "blue","red"), title="For S=10: number of access points")


write.table(round(obs7,3),paste0("/Users/Mac/Desktop/lec/hw1data7.txt"),quote = F,row.names = F,sep = "\t")



